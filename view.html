<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>现代汉语常用词表</title>
<script>
var $ = a => document.querySelector(a);
var page_num_arr = [
[3,1],[4,186],[5,416],[6,645],[7,874],[8,1101],[9,1327],[10,1555],[11,1782],[12,2008],[13,2236],[14,2464],[15,2692],[16,2921],[17,3150],[18,3376],[19,3604],[20,3832],[21,4059],[22,4287],[23,4510],[24,4737],[25,4961],[26,5190],[27,5418],[28,5645],[29,5873],[30,6100],[31,6326],[32,6553],[33,6780],[34,7009],[35,7237],[36,7465],[37,7695],[38,7923],[39,8147],[40,8375],[41,8603],[42,8831],[43,9060],[44,9290],[45,9516],[46,9744],[47,9974],[48,10203],[49,10432],[50,10661],[51,10888],[52,11115],[53,11342],[54,11570],[55,11798],[56,12027],[57,12257],[58,12485],[59,12714],[60,12943],[61,13173],[62,13402],[63,13631],[64,13860],[65,14090],[66,14317],[67,14545],[68,14773],[69,15001],[70,15229],[71,15457],[72,15684],[73,15913],[74,16141],[75,16370],[76,16599],[77,16827],[78,17056],[79,17285],[80,17512],[81,17740],[82,17970],[83,18200],[84,18428],[85,18656],[86,18884],[87,19113],[88,19339],[89,19568],[90,19798],[91,20028],[92,20254],[93,20482],[94,20708],[95,20936],[96,21165],[97,21394],[98,21623],[99,21852],[100,22081],[101,22311],[102,22539],[103,22769],[104,22998],[105,23227],[106,23455],[107,23683],[108,23912],[109,24142],[110,24369],[111,24598],[112,24824],[113,25052],[114,25282],[115,25510],[116,25737],[117,25966],[118,26193],[119,26423],[120,26651],[121,26878],[122,27108],[123,27336],[124,27563],[125,27791],[126,28020],[127,28247],[128,28477],[129,28705],[130,28935],[131,29164],[132,29393],[133,29622],[134,29852],[135,30080],[136,30308],[137,30536],[138,30764],[139,30993],[140,31221],[141,31450],[142,31679],[143,31905],[144,32133],[145,32361],[146,32590],[147,32819],[148,33049],[149,33278],[150,33506],[151,33735],[152,33964],[153,34192],[154,34419],[155,34647],[156,34876],[157,35104],[158,35331],[159,35559],[160,35787],[161,36012],[162,36240],[163,36469],[164,36697],[165,36923],[166,37150],[167,37378],[168,37607],[169,37836],[170,38064],[171,38293],[172,38522],[173,38750],[174,38980],[175,39208],[176,39438],[177,39668],[178,39897],[179,40124],[180,40353],[181,40580],[182,40809],[183,41037],[184,41266],[185,41494],[186,41722],[187,41951],[188,42181],[189,42409],[190,42639],[191,42869],[192,43097],[193,43325],[194,43555],[195,43781],[196,44010],[197,44238],[198,44466],[199,44694],[200,44922],[201,45152],[202,45381],[203,45608],[204,45835],[205,46065],[206,46294],[207,46523],[208,46750],[209,46976],[210,47203],[211,47433],[212,47663],[213,47892],[214,48119],[215,48348],[216,48576],[217,48804],[218,49031],[219,49260],[220,49488],[221,49716],[222,49945],[223,50170],[224,50396],[225,50625],[226,50848],[227,51077],[228,51302],[229,51529],[230,51757],[231,51981],[232,52209],[233,52435],[234,52662],[235,52890],[236,53120],[237,53348],[238,53576],[239,53805],[240,54034],[241,54259],[242,54487],[243,54715],[244,54944],[245,55173],[246,55400],[247,55628],[248,55854],[249,56008]
];
var page_num_map = new Map(page_num_arr);
var page = 1;
var txt = [];
window.onload = () => {
    $('#pgin').oninput = () => setpg(Number($('#pgin').value))
    $('#numin').oninput = () => setpg(num2pg(Number($('#numin').value)));
    fetch('./现代汉语常用词表.txt').then(a => a.text()).then(a => {
        a.split('\n').map(a => {
            let m = a.match(/(^[^0-9\t]+).+?([0-9]+$)/);
            if (m) txt.push([m[1], m[2]]);
        })
    });
    $('#txtin').oninput = () => {
        let t = $('#txtin').value;
        let f = txt.filter(a => a[0].includes(t));
        if (f.length === 0) {
        } else if (f.length === 1) {
            setpg(num2pg(Number(f[0][1])));
            $('#numin').value = f[0][1];
            $('#sel').innerHTML = '';
        } else {
            $('#sel').innerHTML = `<option value="-1">${f.length}项</option>`;
            $('#sel').innerHTML += f.map(([c, n]) => `<option value=${n}>${c}${n}</option>`).join('\n');
        }
    }
    $('#sel').onchange = () => {
        let n = $('#sel').value;
        $('#numin').value = n;
        setpg(num2pg(Number(n)));
    }

    setpg(3);
}
function num2pg(n) {
    for (let i = 0; i < page_num_arr.length; i++) {
        if (page_num_arr[i][1] < n && n < page_num_arr[i+1][1]) {
            return page_num_arr[i][0];
        }
    }
}
function updn(a) {
    if (a == 'dn') setpg(page + 1);
    if (a == 'up') setpg(page - 1);
}
function setpg(p) {
    if (!(1 <= p && p <= 669)) return;
    page = p;
    $('img').src = "./书页/" + String(p).padStart(3, '0') + '.jpg'
    $('#pgin').value = p
    //$('#numin').value = page_num_map.get(p);
}
</script>
<style>
img {
    object-fit: contain;
    width: 50vw;
}
#ctrl {
    display: inline-block;
    vertical-align: top;
    position: sticky;
    top: 10px;
}
body {
    margin: 0 auto;
    width: 50vw;
}
</style>
</head>
<body>
<div id="ctrl">
<button onclick="updn('up')">上一页</button>
<button onclick="updn('dn')">下一页</button>
<input id="pgin" type="number" min="1" max="669" value="1"/>
<input id="numin" type="number" min="1" max="99999"/>
<input id="txtin" type="text"/>
<select id="sel">
</select>
</div>
<img></img>
</body>
</html>
